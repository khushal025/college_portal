<!DOCTYPE html>
<html>
<head>
  <title>Teacher Dashboard</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:Arial;background:linear-gradient(135deg,#1a1a2e,#16213e);color:#fff;overflow-x:hidden;min-height:100vh}
    .header{display:flex;justify-content:space-between;align-items:center;padding:24px 16px;background:rgba(15,23,42,.6);backdrop-filter:blur(8px)}
    .back-btn{background:#e53e3e;color:#fff;border:none;padding:.75rem 1.5rem;border-radius:10px;cursor:pointer;font-weight:600;text-decoration:none;transition:.3s}
    .back-btn:hover{background:#c53030;transform:translateY(-1px)}
    .hamburger{position:fixed;top:24px;right:24px;z-index:1000;background:#7c3aed;border:none;padding:12px;border-radius:8px;cursor:pointer;transition:.3s}
    .hamburger:hover{background:#6d28d9;transform:scale(1.05)} .hamburger .line{width:20px;height:2px;background:#fff;margin:4px 0}
    .slide-menu{position:fixed;top:0;right:-300px;width:280px;height:100vh;background:rgba(15,23,42,.95);backdrop-filter:blur(10px);border-left:1px solid rgba(255,255,255,.1);transition:right .3s;z-index:999;padding-top:80px}
    .slide-menu.active{right:0}
    .menu-section{padding:16px 20px;border-bottom:1px solid rgba(255,255,255,.1)}
    .menu-title{font-size:14px;font-weight:600;color:#94a3b8;margin-bottom:12px;text-transform:uppercase;letter-spacing:.5px}
    .menu-item{display:block;padding:10px 8px;color:#fff;text-decoration:none;font-size:16px;transition:.2s;border-radius:4px;cursor:pointer;border:none;background:none;width:100%;text-align:left}
    .menu-item:hover{background:rgba(124,58,237,.2);color:#c4b5fd;transform:translateX(4px)}
    .main-content{padding:32px 24px;max-width:1200px;margin:0 auto}
    .welcome-section{text-align:center;margin-bottom:48px}
    .welcome-section h2{font-size:28px;margin-bottom:8px;background:linear-gradient(135deg,#c4b5fd,#7c3aed);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .welcome-section p{color:#94a3b8;font-size:16px}
    .search-section{text-align:center;margin-bottom:32px;background:rgba(255,255,255,.08);border-radius:12px;padding:24px;border:1px solid rgba(255,255,255,.1)}
    .search-input{width:300px;padding:12px 16px;border-radius:8px;border:1px solid rgba(255,255,255,.2);background:rgba(255,255,255,.1);color:#fff;font-size:16px;margin-right:12px}
    .search-input::placeholder{color:#94a3b8}
    .load-btn{background:#7c3aed;color:#fff;border:none;padding:12px 24px;border-radius:8px;cursor:pointer;font-weight:600;font-size:16px;transition:.3s}
    .load-btn:hover{background:#6d28d9;transform:translateY(-1px)}
    .upload-section{background:rgba(255,255,255,.05);border-radius:12px;padding:24px;margin-bottom:32px;backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.1)}
    .upload-section h3{margin-bottom:16px;color:#e2e8f0}
    .file-upload{display:flex;gap:16px;align-items:center;flex-wrap:wrap}
    .file-input{flex:1;padding:12px;background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.2);border-radius:8px;color:#fff;font-size:14px}
    .upload-btn{background:linear-gradient(135deg,#7c3aed,#6d28d9);color:#fff;border:none;padding:12px 24px;border-radius:8px;cursor:pointer;font-weight:600;transition:.3s}
    .upload-btn:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(124,58,237,.3)}
    .dashboard-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:24px;margin-top:24px}
    .dashboard-card{background:rgba(255,255,255,.08);border-radius:12px;padding:24px;border:1px solid rgba(255,255,255,.1)}
    .card-title{font-size:18px;font-weight:600;margin-bottom:16px;color:#e2e8f0}
    .no-data{color:#94a3b8;font-style:italic;text-align:center;padding:2rem}
    @media(max-width:768px){.dashboard-grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="header">
    <a href="/" class="back-btn">‚Üê Back</a>
    <h1>üéì Hello Prof. {{ teacher_name }}</h1>
  </div>

  <div class="main-content">
    <div class="welcome-section">
      <h2>Hello {{ teacher_name }}</h2>
      <p>{{ teacher_email }}</p>
      <p>Secure portal for teachers to view student attendance and results</p>
    </div>

    <div class="search-section">
      <h3>üîç Search Student</h3>
      <input type="text" id="rollNoSearch" class="search-input" placeholder="Enter student Roll No">
      <button class="load-btn" onclick="loadStudent()">Search</button>
    </div>

    <div class="dashboard-grid">
      <div class="dashboard-card">
        <h3 class="card-title">üë§ Profile</h3>
        <div id="profileContent">
          <p class="no-data">No student loaded</p>
        </div>
      </div>

      <div class="dashboard-card">
        <h3 class="card-title">üìä Results</h3>
        <div id="resultsContent">
          <p class="no-data">No student loaded</p>
        </div>
      </div>

      <div class="dashboard-card">
        <h3 class="card-title">üìÖ Attendance</h3>
        <div id="attendanceContent">
          <p class="no-data">No student loaded</p>
        </div>
      </div>
    </div>
  </div>

<script>
let currentStudentRoll = null;

async function loadStudent(){
    const rollNo = document.getElementById('rollNoSearch').value.trim();
    if(!rollNo){ alert('Please enter roll number!'); return; }
    currentStudentRoll = rollNo;
    try{
      const res = await fetch(`/api/get_student_data/${rollNo}`);
      const out = await res.json();
      if(out.success){ displayStudentData(out.data); }
      else{ alert('Student not found!'); }
    }catch(e){ alert('Error loading student data!'); }
}

function displayStudentData(data){
    const { student, results, attendance } = data;

    if(student){
      let profileHTML = '';
      for(const [key,val] of Object.entries(student)){
        profileHTML += `<p><strong>${key}:</strong> ${val}</p>`;
      }
      document.getElementById('profileContent').innerHTML = profileHTML;
    }

    if(results){
      let resultsHTML = '';
      for(const [key,val] of Object.entries(results)){
        if(['roll_no','student_name','father_name'].includes(key)) continue;
        resultsHTML += `<p><strong>${key}:</strong> ${val}</p>`;
      }
      document.getElementById('resultsContent').innerHTML = resultsHTML;
    }

    if(attendance){
      let attHTML = '';
      for(const [key,val] of Object.entries(attendance)){
        if(key==='roll_no') continue;
        attHTML += `<p><strong>${key}:</strong> ${val}</p>`;
      }
      document.getElementById('attendanceContent').innerHTML = attHTML;
    }
}
</script>
</body>
</html>
